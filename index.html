<script>
  async function download() {
    const link = document.getElementById("link").value;
    const result = document.getElementById("result");
    result.innerHTML = "Fetching...";

    try {
      const res = await fetch("https://insta-downloader-backend-nzyc.onrender.com/download", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ url: link })
      });

      const data = await res.json();

      if (data.success) {
        if (data.type === "image") {
          result.innerHTML = `
            <img src="${data.mediaUrl}" alt="Instagram Image" />
            <a href="${data.mediaUrl}" download target="_blank">⬇️ Click to Download Image</a>
          `;
        } else if (data.type === "video") {
          result.innerHTML = `
            <video controls>
              <source src="${data.mediaUrl}" type="video/mp4">
              Your browser does not support the video tag.
            </video>
            <a href="${data.mediaUrl}" download target="_blank">⬇️ Click to Download Video</a>
          `;
        }
      } else {
        result.innerHTML = "❌ Error: " + data.error;
      }
    } catch (err) {
      result.innerHTML = "❌ Fetch Error: " + err.message;
    }
  }
</script>
